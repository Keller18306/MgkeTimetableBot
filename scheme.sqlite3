--
-- Файл сгенерирован с помощью SQLiteStudio v3.4.4 в сб июнь 3 14:08:51 2023
--
-- Использованная кодировка текста: System
--
PRAGMA foreign_keys = off;
BEGIN TRANSACTION;

-- Таблица: alice_users
CREATE TABLE alice_users (
    id      INTEGER PRIMARY KEY,
    userId  STRING  UNIQUE,
    mode    STRING,
    [group] STRING,
    teacher STRING
);


-- Таблица: api
CREATE TABLE api (
    id          INTEGER PRIMARY KEY AUTOINCREMENT,
    service     STRING,
    fromId      STRING,
    limitPerSec INT     NOT NULL,
    iv          STRING,
    last_time   BIGINT
);


-- Таблица: chat_options
CREATE TABLE chat_options (
    service                  STRING       NOT NULL,
    id                       INTEGER      NOT NULL,
    accepted                 BOOLEAN      DEFAULT (0),
    ref                      STRING (255),
    scene                    STRING,
    mode                     STRING (16),
    [group]                  STRING (3),
    teacher                  STRING (255),
    noticeChanges            BOOLEAN      DEFAULT (0),
    showAbout                BOOLEAN      DEFAULT (1),
    showDaily                BOOLEAN      DEFAULT (1),
    showWeekly               BOOLEAN      DEFAULT (1),
    showCalls                BOOLEAN      DEFAULT (1),
    showFastGroup            BOOLEAN      DEFAULT (1),
    showFastTeacher          BOOLEAN      DEFAULT (1),
    removePastDays           BOOLEAN      DEFAULT (1),
    deleteLastMsg            BOOLEAN      DEFAULT (0),
    lastMsgId                INTEGER,
    lastMsgTime              BIGINT       DEFAULT (0),
    deleteUserMsg            BOOLEAN      DEFAULT (0),
    allowSendMess            BOOLEAN      DEFAULT (1),
    subscribeMess            BOOLEAN      DEFAULT (1),
    needUpdateButtons        BOOLEAN      DEFAULT (0),
    showParserTime           BOOLEAN      DEFAULT (0),
    historyGroup             STRING       NOT NULL
                                          DEFAULT "[]",
    historyTeacher           STRING       NOT NULL
                                          DEFAULT "[]",
    eula                     BOOLEAN      DEFAULT (0),
    deactivateSecondaryCheck BOOLEAN      DEFAULT (0) 
);


-- Таблица: storage
CREATE TABLE storage (
    storage STRING NOT NULL,
    key     STRING NOT NULL,
    value   STRING,
    time    INT
);


-- Таблица: students
CREATE TABLE students (
    id         BIGINT      PRIMARY KEY,
    p          INTEGER,
    peerId     INTEGER     REFERENCES vk_bot_chats (peerId),
    vk_id      INTEGER,
    name       TEXT (1024) NOT NULL,
    skip_count INTEGER     DEFAULT (0),
    has_access BOOLEAN     DEFAULT (0),
    skip       BOOLEAN     DEFAULT (0),
    ignore     BOOLEAN     DEFAULT (0) 
);


-- Таблица: tg_bot_chats
CREATE TABLE tg_bot_chats (
    id        INTEGER PRIMARY KEY AUTOINCREMENT,
    peerId    STRING  UNIQUE
                      NOT NULL,
    domain    STRING,
    firstName STRING,
    lastName  STRING,
    lang      STRING
);


-- Таблица: viber_bot_chats
CREATE TABLE viber_bot_chats (
    id            INTEGER PRIMARY KEY AUTOINCREMENT,
    peerId        STRING  UNIQUE
                          NOT NULL,
    theme         STRING  DEFAULT white,
    lastUpdateDI  BIGINT  DEFAULT (0),
    name          STRING,
    device_os     STRING,
    device_type   STRING,
    viber_version STRING
);


-- Таблица: vk_app_users
CREATE TABLE vk_app_users (
    id             INTEGER      PRIMARY KEY AUTOINCREMENT,
    user_id        BIGINT       UNIQUE
                                NOT NULL,
    accepted       BOOLEAN      DEFAULT (0) 
                                NOT NULL,
    ref            STRING (255),
    [group]        STRING (3),
    teacher        STRING (255),
    theme_id       INT          DEFAULT (0),
    adblock        BOOLEAN      DEFAULT (0),
    firstPage      STRING (16),
    insert_time    BIGINT       NOT NULL,
    last_time      BIGINT       NOT NULL,
    allowBotAccept BOOLEAN      DEFAULT (1) 
);


-- Таблица: vk_bot_chats
CREATE TABLE vk_bot_chats (
    id               INTEGER PRIMARY KEY,
    peerId           INTEGER UNIQUE
                             NOT NULL,
    allowVkAppAccept BOOLEAN DEFAULT (1) 
);


-- Индекс: api_index
CREATE INDEX api_index ON api (
    service,
    fromId
);


-- Индекс: options_indexes
CREATE INDEX options_indexes ON chat_options (
    mode,
    "group",
    teacher,
    noticeChanges,
    allowSendMess,
    accepted,
    deactivateSecondaryCheck,
    subscribeMess
);


-- Индекс: options_key
CREATE UNIQUE INDEX options_key ON chat_options (
    service,
    id ASC
);


-- Индекс: peer_Id
CREATE INDEX peer_Id ON students (
    peerId
);


-- Индекс: storage_index
CREATE UNIQUE INDEX storage_index ON storage (
    storage,
    key
);


-- Индекс: vk_id
CREATE INDEX vk_id ON students (
    vk_id
);


COMMIT TRANSACTION;
PRAGMA foreign_keys = on;
